<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.0.2">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"chenwj1103.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="学习，坚持。">
<meta property="og:type" content="website">
<meta property="og:title" content="茄子的博客">
<meta property="og:url" content="http://chenwj1103.github.io/page/8/index.html">
<meta property="og:site_name" content="茄子的博客">
<meta property="og:description" content="学习，坚持。">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="陈伟杰">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://chenwj1103.github.io/page/8/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>茄子的博客</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="茄子的博客" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">茄子的博客</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">技术博客</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="tags fa-fw"></i>标签<span class="badge">68</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="th fa-fw"></i>分类<span class="badge">26</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="archive fa-fw"></i>归档<span class="badge">74</span></a>

  </li>
        <li class="menu-item menu-item-sitemap">

    <a href="/sitemap.xml" rel="section"><i class="sitemap fa-fw"></i>站点地图</a>

  </li>
        <li class="menu-item menu-item-commonweal">

    <a href="/404/" rel="section"><i class="heartbeat fa-fw"></i>公益 404</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://chenwj1103.github.io/2017-11-06/tomcat%E5%AD%A6%E4%B9%A0-%E7%BB%93%E6%9E%84%E5%92%8C%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/favicon.ico">
      <meta itemprop="name" content="陈伟杰">
      <meta itemprop="description" content="学习，坚持。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="茄子的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017-11-06/tomcat%E5%AD%A6%E4%B9%A0-%E7%BB%93%E6%9E%84%E5%92%8C%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE/" class="post-title-link" itemprop="url">tomcat学习-结构和基本配置</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-11-06 23:34:04" itemprop="dateCreated datePublished" datetime="2017-11-06T23:34:04+08:00">2017-11-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-08-21 01:03:09" itemprop="dateModified" datetime="2020-08-21T01:03:09+08:00">2020-08-21</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/web%E5%AE%B9%E5%99%A8/" itemprop="url" rel="index"><span itemprop="name">web容器</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>10k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>9 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <ul>
<li>Tomcat的安装目录结构</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">bin: 启动和关闭Tomcat脚本文件。</span><br><span class="line">conf: Tomcat服务器的各种配置文件，包括：server.xml、web.xml、catalina.policy等。</span><br><span class="line">lib: Tomcat服务器和所有web应用可以访问的jar包。</span><br><span class="line">logs: Tomcat的日志文件。</span><br><span class="line">webapps: Tomcat自带的两个web应用：admin和manager，用来管理Tomcat的Web服务。</span><br><span class="line">work: JSP经过Tomcat编译后生成的Servlet。</span><br><span class="line">temp: Tomcat运行时的临时文件。</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>Tomcat常用配置文件</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">server.xml：Tomcat中最重要的配置文件，定义了tomcat的体系结构，包括连接器端口、连接数、集群、虚拟目录、访问日志等的设置。</span><br><span class="line">context.xml：全局context的配置文件，包括JNDI等信息的配置。</span><br><span class="line">tocmat-users.xml：Tocmat管理员身份的配置文件，关键是设置管理员账号的密码。</span><br><span class="line">logging.properties：Tocmat日志配置文件，可以修改默认的Tocmat日志路径和名称。</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>Tomcat JVM参数调整</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">根据系统物理内存大小合理设置下列五个参数catalina.sh&#x2F;catalina.bat</span><br><span class="line"></span><br><span class="line">-server </span><br><span class="line">-Xms512m </span><br><span class="line">-Xmx512m</span><br><span class="line">-XX:PermSize&#x3D;128m</span><br><span class="line">-XX:MaxPermSize&#x3D;128m</span><br><span class="line"></span><br><span class="line">   一般情况下，设置-Xms&#x3D;-Xmx、-XX:PermSize&#x3D;-XX:MaxPermSize，正式服务器必须设置以上参数，以尽可能压榨服务器性能。</span><br><span class="line">相关参数取值需要根据实际情况考虑，不要超过(物理内存-其他程序内存)的80%即可。</span><br><span class="line"></span><br><span class="line">没有特殊理由，尽量不要对上述五个参数外的其他JVM参数进行设置;</span><br><span class="line">无法保证各种操作系统平台的可移植性;</span><br><span class="line">过度干涉JVM内存管理会导致无法预料的后果;</span><br><span class="line">如果在Windows平台上将解压版的Tomcat安装为服务，可以通过修改批处理文件$CATALINA_HOME&#x2F;bin&#x2F;service.bat对JVM参数进行调整。</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>Tomcat日志配置</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line">Tomcat日志信息包括访问日志和运行日志。</span><br><span class="line"></span><br><span class="line">访问日志用于对用户访问系统的行为进行跟踪记录，主要记录用户访问的时间、对应的IP</span><br><span class="line">地址、访问的资料等信息。记录访问日志主要是基于对系统安全的考虑，对系统中一些重</span><br><span class="line">要、敏感信息的资料访问历史进行记录，便于对资源的访问历史进行追踪，对于敏感信息</span><br><span class="line">未经授权访问等进行事后追查有一定帮助。但记录访问日志会对服务器性能产生一定的影</span><br><span class="line">响，在生产系统中需要慎用。</span><br><span class="line"></span><br><span class="line">运行日志主要记录程序运行的一些信息，其中的异常错误信息可以为我们定位错误。</span><br><span class="line">从6.0版本开始，Tomcat的日志接口采用是对Apache Commons Logging日志接口进行独</span><br><span class="line">立封装，缺省配置下，该日志接口采用硬编码使用java.util.logging日志框架。</span><br><span class="line"></span><br><span class="line">由于Tomcat发布版本中独立封装的Apache Commons Logging接口并没有对接口完全实</span><br><span class="line">现，如果要选择不同的日志框架就需要将该日志接口替换为完全实现的版本。</span><br><span class="line"></span><br><span class="line">缺省配置下，Tomcat是不记录访问日志的，可以通过如下配置允许Tomcat记录访问日志：</span><br><span class="line"></span><br><span class="line">修改$CATALINA_HOME&#x2F;server.xml，在Host标签下，找到如下配置信息，去掉两端的注释</span><br><span class="line">就会启用访问日志记录功能：</span><br><span class="line"></span><br><span class="line">&lt;Valve className&#x3D;&quot;org.apache.catalina.valves.AccessLogValve&quot; directory&#x3D;&quot;logs&quot;</span><br><span class="line"></span><br><span class="line">prefix&#x3D;&quot;localhost_access_log.&quot; suffix&#x3D;&quot;.txt&quot; pattern&#x3D;&quot;common&quot; resolveHosts&#x3D;&quot;false&quot;&#x2F;&gt;</span><br><span class="line"></span><br><span class="line">通过对pattern项的修改，可以改变日志输出的内容。该项值可以为： common 与 combined，对应的日志输出内容如下所示：</span><br><span class="line"></span><br><span class="line">common: %h %l %u %t %r %s %b</span><br><span class="line"></span><br><span class="line">combined: %h %l %u %t %r %s %b %&#123;Referer&#125;i %&#123;User-Agent&#125;i</span><br><span class="line"></span><br><span class="line">pattern 也可以根据需要自由组合, 例如 pattern&#x3D;&quot;%h %l&quot;，对 于各 fields 字段的含义请参照Tomcat官方文档。</span><br><span class="line"></span><br><span class="line">在不同的环境下，需要设置不同的日志级别，在生产环境中，为了提高效率和稳定性，一般</span><br><span class="line">会将日志级别设置为相对较高的级别，而开发环境中为了跟踪程序流程，可以将日志级别</span><br><span class="line">调整为较低的级别。不同日志框架有不同的日志级别，常用的日志框架对应级别如下：</span><br><span class="line"></span><br><span class="line">Java.util.logging对应的日志级别由高到低分别为：</span><br><span class="line"></span><br><span class="line">severe &gt; warning &gt; info &gt; config &gt; fine &gt; finer &gt; finest</span><br><span class="line"></span><br><span class="line">org.apache.log4j对应的日志级别由高到低分别为：</span><br><span class="line"></span><br><span class="line">fatal &gt; error &gt; warn &gt; info &gt; debug &gt; trace</span><br><span class="line"></span><br><span class="line">在缺省配置下，Tomcat采用Java.util.logging日志框架，对应的配置文件</span><br><span class="line">为$CATALINA_HOME&#x2F; logging.properties，常用的日志级别设定方法如下：</span><br><span class="line"></span><br><span class="line">设置catalina日志的级别为：FINE</span><br><span class="line"></span><br><span class="line">1catalina.org.apache.juli.FileHandler.level &#x3D; FINE</span><br><span class="line"></span><br><span class="line">禁用catalina日志的输出：</span><br><span class="line"></span><br><span class="line">1catalina.org.apache.juli.FileHandler.level &#x3D; OFF</span><br><span class="line"></span><br><span class="line">设置catalina所有的日志消息均输出：</span><br><span class="line"></span><br><span class="line">1catalina.org.apache.juli.FileHandler.level &#x3D; ALL</span><br><span class="line"></span><br><span class="line">Log4j是目前应用最广的日志框架，可以使用Log4j替换Tomcat缺省采用的</span><br><span class="line">java.util.logging</span><br><span class="line">日志框架，步骤如下：</span><br><span class="line"></span><br><span class="line">创建log4j配置文件log4j.properties ，保存在$CATALINA_HOME&#x2F;lib 下。</span><br><span class="line"></span><br><span class="line">从Apache官网Log4J项目下载Log4J（1.2版本以后）。</span><br><span class="line"></span><br><span class="line">从Apache官网Tomcat项目下载tomcat-juli.jar和tomcat-juli-adapters.jar。</span><br><span class="line"></span><br><span class="line">复制log4j.jar、tomcat-juli-adapters.jar到$CATALINA_HOME&#x2F;lib下。</span><br><span class="line"></span><br><span class="line">用tomcat-juli.jar覆盖$CATALINA_HOME&#x2F;bin下的同名文件。</span><br><span class="line"></span><br><span class="line">删除Tomcat的缺省日志配置文件$CATALINA_HOME&#x2F;conf&#x2F; logging.properties，以避免生成一些冗余的空日志文件。</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<ul>
<li>Tomcat URL编码格式设置</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">缺省情况下，如果URL当中包含有非英文字符，需要通过在程序对URL进行转码处理，否</span><br><span class="line">则URL中的非英文字符无法保证正确解析。在无特殊要求的情况下，需要将URL编码设置为</span><br><span class="line">和项目统一的编码格式，目前公司大部分项目都统一采用UTF-8字符编码方式，示例如下：</span><br><span class="line"></span><br><span class="line">&lt;Connector port&#x3D;&quot;8087&quot; protocol&#x3D;&quot;HTTP&#x2F;1.1&quot; connectionTimeout&#x3D;&quot;20000&quot;</span><br><span class="line">redirectPort&#x3D;&quot;8443&quot; URIEncoding&#x3D;&quot;utf-8&quot; &#x2F;&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>Tomcat 常见问题总结</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">JVM内存溢出(OOM)，分为堆内存溢出和PermGen区内存溢出：</span><br><span class="line"></span><br><span class="line">java.lang.OutOfMemoryError: PermGen space</span><br><span class="line"></span><br><span class="line">PermGen space(Permanent Generation space)，是指内存的永久保存区域，主要用于存</span><br><span class="line">放Class和Meta信息的，Class在被Loader时就会被放到PermGen space中, 它和存放类实</span><br><span class="line">例(Instance)的Heap区域不同，GC(Garbage Collection)不会在主程序运行期对其进行清</span><br><span class="line">理，所以如果应用中有很多CLASS的话，就很可能出现PermGen space错误。如果加载的Class超过MaxPermSize，就会抛出该异常，可以通过调整MaxPermSize进行解决。</span><br><span class="line"></span><br><span class="line">java.lang.OutOfMemoryError: Java heap space</span><br><span class="line"></span><br><span class="line">JVM堆是指java程序运行过程中JVM可以调配使用的内存空间。JVM在启动的时候会自动</span><br><span class="line">设置Heap size的值，其初始空间(-Xms)是物理内存的1&#x2F;64，最大空间(-Xmx)是物理内存</span><br><span class="line">的1&#x2F;4。可以利用JVM提供的-Xmn -Xms -Xmx等选项可进行设置。Heap size 的大小是</span><br><span class="line">Young Generation 和Tenured Generaion 之和。在JVM中如果98％的时间是用于GC且</span><br><span class="line">可用的Heap size 不足2％的时候将抛出此异常信息。</span><br><span class="line"></span><br><span class="line">大量用户访问时浏览器没有响应</span><br><span class="line">并发线程数设置太小，调整$CATALINA&#x2F;conf&#x2F;server.xml中连接器对应的请求处理线程数。</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>tomcat的并发介绍</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">对web应用开发者来说，我们很关心应用可同时处理的请求数，以及响应时间。</span><br><span class="line"></span><br><span class="line">对tomcat来说，每一个进来的请求(request)都需要一个线程，直到该请求结束。如果同时</span><br><span class="line">进来的请求多于当前可用的请求处理线程数，额外的线程就会被创建，直到到达配置的最大</span><br><span class="line">线程数(maxThreads属性值)。如果仍就同时接收到更多请求，这些来不及处理的请求就会</span><br><span class="line">在Connector创建的ServerSocket中堆积起来，直到到达最大的配置值(acceptCount属性</span><br><span class="line">值)。至此，任何再来的请求将会收到connection refused错误，直到有可用的资源来处理</span><br><span class="line">它们。</span><br><span class="line"></span><br><span class="line">这里我们关心的是tomcat能同时处理的请求数和请求响应时间，显然Connector元素</span><br><span class="line">的maxThreads和acceptCount属性对其有直接的影响。无论acceptCount值为多</span><br><span class="line">少，maxThreads直接决定了实际可同时处理的请求数。而不管maxThreads如何acceptCount</span><br><span class="line">则决定了有多少请求可等待处理。然而，不管是可立即处理请求还是需要放入等待区，都</span><br><span class="line">需要tomcat先接受该请求(即接受client的连接请求，建立socketchannel)，那么tomcat</span><br><span class="line">同时可建立的连接数(maxConnections属性值)也会影响可同时处理的请求数。</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<ul>
<li>tomcat并发配置１</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">tomcat的http connector有三种：bio、nio、apr。从上面的属性描述中可以看出对于不同</span><br><span class="line">的connector实现，相同的属性可能会有不同的默认值和不同的处理策略，所以在调整配</span><br><span class="line">置前，要先弄清楚各种实现之间的不同，以及当前部署容器使用的是哪种connector。</span><br><span class="line">查阅Tomcat7 http connector 配置文档Connector Comparison部分便可获知各种connector实现间的差异。</span><br><span class="line">怎样才能知道容器使用的是何种connector实现？启动tomcat后，访问Server Status Page，看到如下信息即可知道使用的是何种connector：</span><br><span class="line"></span><br><span class="line">我的OS是windows，所以tomcat默认使用的是aprconnector。在linux上，默认使用的是bio connector。与nio相比，bio性能较低。将&lt;TOMCAT_HOME&gt;&#x2F;conf&#x2F;server.xml中的如下配置片段：</span><br><span class="line"></span><br><span class="line">&lt;Connectorport&#x3D;&quot;8080&quot;protocol&#x3D;&quot;HTTP&#x2F;1.1&quot;</span><br><span class="line">               connectionTimeout&#x3D;&quot;20000&quot;</span><br><span class="line">               redirectPort&#x3D;&quot;8443&quot; &#x2F;&gt;</span><br><span class="line">修改为：</span><br><span class="line"></span><br><span class="line">&lt;Connectorport&#x3D;&quot;8080&quot;protocol&#x3D;&quot;org.apache.coyote.http11.Http11NioProtocol&quot;</span><br><span class="line">               connectionTimeout&#x3D;&quot;20000&quot;</span><br><span class="line">               redirectPort&#x3D;&quot;8443&quot; &#x2F;&gt;</span><br><span class="line">就可将http connector切换至nio了。</span><br><span class="line"></span><br><span class="line">　tomcat的最大线程数设置：</span><br><span class="line"></span><br><span class="line">Tomcat的server.xml中连接器设置如下</span><br><span class="line"></span><br><span class="line">   &lt;Connectorport&#x3D;&quot;8080&quot;  maxThreads&#x3D;&quot;150&quot;minSpareThreads&#x3D;&quot;25&quot; maxSpareThreads&#x3D;&quot;75&quot;  enableLookups&#x3D;&quot;false&quot;redirectPort&#x3D;&quot;8443&quot; acceptCount&#x3D;&quot;100&quot;  debug&#x3D;&quot;0&quot;connectionTimeout&#x3D;&quot;20000&quot;  disableUploadTimeout&#x3D;&quot;true&quot;&#x2F;&gt; </span><br><span class="line"> tomcat在配置时设置最大线程数，当前线程数超过这个数值时会出错</span><br><span class="line"></span><br><span class="line">minProcessors：最小空闲连接线程数，用于提高系统处理性能，默认值为10</span><br><span class="line">maxProcessors：最大连接线程数，即：并发处理的最大请求数，默认值为75</span><br><span class="line">acceptCount：允许的最大连接数，应大于等于maxProcessors，默认值为100</span><br><span class="line">enableLookups：是否反查域名，取值为：true或false。为了提高处理能力，</span><br><span class="line">应设置为false  </span><br><span class="line">connectionTimeout：网络连接超时，单位：毫秒。设置为0表示永不超时，这样设置有隐患的。通常可设置为30000毫秒。</span><br><span class="line">其中和最大连接数相关的参数为maxProcessors和acceptCount。如果要加大并发连接数，应同时加大这两个参数。</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>如何加大tomcat可以使用的内存</li>
</ul>
<p>tomcat默认可以使用的内存为128MB，在较大型的应用项目中，这点内存是不够的，需要调大。<br>Unix下，在文件{tomcat_home}/bin/catalina.sh的前面，增加如下设置：<br>JAVA_OPTS=’-Xms【初始化内存大小】 -Xmx【可以使用的最大内存】’<br>需要把这个两个参数值调大。例如：<br>JAVA_OPTS=’-Xms256m -Xmx512m’<br>表示初始化内存为256MB，可以使用的最大内存为512MB</p>
<ul>
<li>Tomcat中的并发配置２</li>
</ul>
<p><a target="_blank" rel="noopener" href="http://tomcat.apache.org/tomcat-7.0-doc/config/http.html">官网关于线程数的配置</a></p>
<p><a target="_blank" rel="noopener" href="http://www.365mini.com/page/tomcat-connector-mode.htm">修改Tomcat Connector运行模式</a></p>
<p>tomcat的线程配置有两种：可以在connector中配置，也可以配置executor。</p>
<p>连接器中的线程配置是私有的，连接器自己的配置只能自己使用；而线程池可以被共享，<br>多个连接器通过executor属性关联到连接池的name完成配置（见下图）；<br>一旦连接器中配置了一个存在的executor，那么线程池的配置将会覆盖连接器的线程配置。<br><img src="/images/tomcat/tomcat3.png" alt="连接器和线程池"></p>
<p>线程池覆盖连接器中的线程配置，主要是覆盖maxThreads和minSpareThreads两个参数，这两个参数在线程池标签和连接器标签中都存在。<br>    a. 对于线程池而言：最主要的配置项是maxThreads和minSpareThreads（参看3.1表格，官网全部配置项参看4.1链接），前者代表线程池中可以创建的最大线程数，后者代表当线程池空闲的时候保留的线程数量，当线程池覆盖连接器的线程配置的时候，最主要的是覆盖这两个参数，连接器如何关联线程池，参看上文截图。<br>    b. 对于连接器而言：线程相关的主要参数有四个——maxThreads、minSpareThreads、maxConnections、acceptCount，如果连接器关联了线程池，那么maxThreads和minSpareThreads会被覆盖（重要的事情反复说），acceptCount和maxConnections继续生效；<br>    maxThreads：一个请求分配一个线程处理，其实就是serversocket.accept之后，新建了一个线程去处理这个接受的socket，然后这个连接器可以建立的最大线程数量即为maxThreads配置的值，如果是多个连接器关联了同一个线程池，那么多个连接器允许建立的线程数量之和即为maxThreads的值；<br>    minSpareThreads：如果请求少或者没有请求，那么tomcat就会主动关闭一些不用的线程，但是至少会保留minSpareThreads配置的线程数；<br>    maxConnections：表示可以同时被当前连接器处理的请求数量，这个配置项需要和maxThreads进行对比，一个请求一旦被接受处理就会分配给一个线程，这时候能够同时处理多少个请求取决于maxConnections和maxThreads两个配置项中的较小者，如果连接器是BIO则maxConnections默认等于maxThreads（连接器的maxThreads，如果关联了线程池，则为线程池中的maxThreads），NIO2默认是10000，APR默认是8192（BIO/NIO/NIO2/APR主要是根据connector的protocol属性，这个属性可以配置小表中的类）；<br>    举个例子，连接器中maxThreads=200，maxConnections=100，这时候因为线程池最多只允许创建100个线程，因此能被同时处理的请求数量是100，取决于两者中的较小者；但是如果连接器关联了线程池maxThreads=200，连接器A的maxConnections=120，连接器B的maxConnections=100，这时候对于连接器A而言，处理请求的最大的线程数是120，不会超过120，但是能不能达到120还需要看线程池中的可用的线程数，如果这时候连接器B已经拿了100个线程，那么此时A只能拿到100个线程；</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Java Blocking Connector BIO    Java Nio Connector NIO     Java Nio2 Connector NIO2    APRnative Connector</span><br><span class="line">APR</span><br><span class="line">Classname    Http11Protocol    Http11NioProtocol    Http11Nio2Protocol    Http11AprProtocol</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<pre><code>acceptCount：相当于建立ServerSocket的时候构造函数中传入的backlog参数，表</code></pre>
<p>示serversocket中完成三次握手后（成功建立TCP连接）允许等待被accept的socket数量，<br>已经建立好了TCP连接，但是socket还没有被accept取出来处理；</p>
<ul>
<li><p>Tomcat结构<br>Tomcat是一个基于组件的服务器，它的构成组件都是可配置的，其中最外层的组件是Catalina Servlet容器，其他的组件按照一定的格式要求配置在这个顶层容器中。Tomcat的各个组件是在<TOMCAT_HOME>\conf\server.xml文件中配置的，Tomcat服务器默认情况下对各种组件都有默认的实现，下面通过分析server.xml文件来理解Tomcat的各个组件是如何组织的。server.xml文件的基本组成结构如下。</p>
<p><img src="/images/tomcat/tomcat1.jpg"></p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">XML配置文件结构</span><br><span class="line">&lt;Server&gt;                     顶层类元素：一个配置文件中只能有一个&lt;Server&gt;元素，可包含多个Service。</span><br><span class="line">    &lt;Service&gt;                顶层类元素：本身不是容器，可包含一个Engine，多个Connector。</span><br><span class="line">        &lt;Connector&#x2F;&gt;         连接器类元素：代表通信接口。</span><br><span class="line">           &lt;Engine&gt;   容器类元素：为特定的Service组件处理所有客户请求，可包含多个Host。</span><br><span class="line">              &lt;Host&gt;    容器类元素：为特定的虚拟主机处理所有客户请求，可包含多个Context。</span><br><span class="line">                 &lt;Context&gt;   容器类元素：为特定的Web应用处理所有客户请求。</span><br><span class="line">                 &lt;&#x2F;Context&gt;</span><br><span class="line">               &lt;&#x2F;Host&gt;</span><br><span class="line">              &lt;&#x2F;Engine&gt;</span><br><span class="line">     &lt;&#x2F;Service&gt;</span><br><span class="line">&lt;&#x2F;Server&gt;</span><br><span class="line"></span><br><span class="line">1)Service</span><br><span class="line">Service组件是一些Connector组件的集合，它本身不是一个容器，所以在这里不能定义日志</span><br><span class="line">等组件。一个Service组件中只能有一个Engine组件，可以包含多个Connector组件。</span><br><span class="line"></span><br><span class="line">2)Connector组件</span><br><span class="line">Connector组件表示一个接口，通过这个接口接收客户的请求，然户发送给其他的容器组件，最后再把服务器的响应结果传递给客户。</span><br><span class="line"></span><br><span class="line">3) Engine, Host和context</span><br><span class="line">上面介绍的3个组件本身并不能处理客户请求，也不能生成响应。在Tomcat中只有3个组件是</span><br><span class="line">可以处理客户请求并生成响应的，这3个组件分别是 Engine、Host和Context组件。这3个组</span><br><span class="line">件分别代表了不同的服务范围，通过嵌套关系可以知道3个组件的范围有如下的关系：Engine&gt;Host&gt;Context。</span><br><span class="line">a.Engine组件下可以包含多个Host组件，它为特定的Service组件处理所有客户请求。</span><br><span class="line">b.一个Host组件代表一个虚拟主机，一个虚拟主机中可以包含多个Web应用（Context组件）。</span><br><span class="line">c.Context组件代表一个Web应用。</span><br><span class="line">Tomcat的各个组件关系，可以用下图描述。</span><br></pre></td></tr></table></figure>
<p> <img src="/images/tomcat/tomcat2.jpg"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">2. Tomcat处理一个HTTP请求的过程</span><br><span class="line">假设来自客户的请求为： http:&#x2F;&#x2F;localhost:8080&#x2F;wsota&#x2F;wsota_index.jsp </span><br><span class="line">1) 请求被发送到本机端口8080，被在那里侦听的Coyote HTTP&#x2F;1.1 Connector获得 </span><br><span class="line">2) Connector把该请求交给它所在的Service的Engine来处理，并等待来自Engine的回应 </span><br><span class="line">3) Engine获得请求localhost&#x2F;wsota&#x2F;wsota_index.jsp，匹配它所拥有的所有虚拟主机Host </span><br><span class="line">4) Engine匹配到名为localhost的Host（即使匹配不到也把请求交给该Host处理，因为该Host被定义为该Engine的默认主机） </span><br><span class="line">5) localhost Host获得请求&#x2F;wsota&#x2F;wsota_index.jsp，匹配它所拥有的所有Context </span><br><span class="line">6) Host匹配到路径为&#x2F;wsota的Context（如果匹配不到就把该请求交给路径名为&quot;&quot;的Context去处理） </span><br><span class="line">7) path&#x3D;&quot;&#x2F;wsota&quot;的Context获得请求&#x2F;wsota_index.jsp，在它的mapping table中寻找对应的servlet </span><br><span class="line">8) Context匹配到URL PATTERN为*.jsp的servlet，对应于JspServlet类 </span><br><span class="line">9) 构造HttpServletRequest对象和HttpServletResponse对象，作为参数调用JspServlet的doGet或doPost方法 </span><br><span class="line">10)Context把执行完了之后的HttpServletResponse对象返回给Host </span><br><span class="line">11)Host把HttpServletResponse对象返回给Engine </span><br><span class="line">12)Engine把HttpServletResponse对象返回给Connector </span><br><span class="line">13)Connector把HttpServletResponse对象返回给客户browser</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="http://www.cnblogs.com/xzpp/archive/2012/06/15/2550473.html">tomcat的结构</a></p>
<p><a target="_blank" rel="noopener" href="http://tomcat.apache.org/tomcat-8.0-doc/config/http.html">官网connector配置</a></p>
<p><a target="_blank" rel="noopener" href="http://tomcat.apache.org/tomcat-8.0-doc/config/executor.html">官网executor配置</a></p>
<p><a target="_blank" rel="noopener" href="http://www.cnblogs.com/doit8791/archive/2012/10/27/2742768.html">参考资料１</a></p>
<p><a target="_blank" rel="noopener" href="http://www.cnblogs.com/softidea/p/5750791.html">参考资料２</a></p>
<p><a target="_blank" rel="noopener" href="http://www.cnblogs.com/softidea/p/5750791.html">参考资料３</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/w1992wishes/article/details/79242797">tomcat源码解析</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://chenwj1103.github.io/2017-11-03/SQL%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B8%80%20%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5%E5%92%8C%E6%93%8D%E4%BD%9C/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/favicon.ico">
      <meta itemprop="name" content="陈伟杰">
      <meta itemprop="description" content="学习，坚持。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="茄子的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017-11-03/SQL%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8D%97%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B8%80%20%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5%E5%92%8C%E6%93%8D%E4%BD%9C/" class="post-title-link" itemprop="url">《SQL基础》SQL学习指南学习笔记一　数据库的基本概念和操作</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-11-03 01:07:37" itemprop="dateCreated datePublished" datetime="2017-11-03T01:07:37+08:00">2017-11-03</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-08-21 01:03:09" itemprop="dateModified" datetime="2020-08-21T01:03:09+08:00">2020-08-21</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/sql/" itemprop="url" rel="index"><span itemprop="name">sql</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>15k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>13 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="基本术语"><a href="#基本术语" class="headerlink" title="基本术语"></a>基本术语</h2><ol>
<li>实体：数据库用户所关注的对象。</li>
<li>列：存储在表中的独立的数字片段。</li>
<li>行：所有列的一个集合，完整的描述了一个实体或者实体上的某个行为，也称之为记录。</li>
<li>表：行的集合，既可以存在内存中，也可以持久化到硬盘上。</li>
<li>结果集：未持久化表的另一个名字，一般为SQL的查询结果。</li>
<li>主键：用于唯一标识表中的每个行的一个或者多个列。</li>
<li>外键：一个或者多个用于识别其他表中的某一个行的列。</li>
</ol>
<h2 id="使用mysql命令行工具"><a href="#使用mysql命令行工具" class="headerlink" title="使用mysql命令行工具"></a>使用mysql命令行工具</h2><ul>
<li>使用命令行工具可以制定用户名和想要连接的数据库</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">zhuningning@ubuntu:~$ mysql -u lrngsql -p bank</span><br><span class="line">Enter password: </span><br><span class="line">Welcome to the MySQL monitor.  Commands end with ; or \g.</span><br><span class="line">Your MySQL connection id is 10</span><br><span class="line">Server version: 5.7.20 MySQL Community Server (GPL)</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2017, Oracle and&#x2F;or its affiliates. All rights reserved.</span><br><span class="line"></span><br><span class="line">Oracle is a registered trademark of Oracle Corporation and&#x2F;or its</span><br><span class="line">affiliates. Other names may be trademarks of their respective</span><br><span class="line">owners.</span><br><span class="line"></span><br><span class="line">Type &#39;help;&#39; or &#39;\h&#39; for help. Type &#39;\c&#39; to clear the current input statement.</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>出现如上的结果表示连接成功。</p>
<h2 id="表的创建"><a href="#表的创建" class="headerlink" title="表的创建"></a>表的创建</h2><ul>
<li>以下为创建表person的语句:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">mysql&gt; create table person(</span><br><span class="line">    -&gt; person_id smallint unsigned,</span><br><span class="line">    -&gt; fname varchar(20),</span><br><span class="line">    -&gt; lname varchar(20),</span><br><span class="line">    -&gt; gender enum(&#39;M&#39;,&#39;F&#39;),</span><br><span class="line">    -&gt; birth_date date,</span><br><span class="line">    -&gt; street varchar(20),</span><br><span class="line">    -&gt; ciry varchar(20),</span><br><span class="line">    -&gt; state varchar(20),</span><br><span class="line">    -&gt; country varchar(20),</span><br><span class="line">    -&gt; postal_code varchar(20),</span><br><span class="line">    -&gt; constraint pk_person primary key(person_id)</span><br><span class="line">    -&gt; );</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li><p>注意以上的gender　enum 类型，可以约束赋值只能为Ｍ和Ｆ；</p>
</li>
<li><p>desc person该语句可以显示表结构；</p>
</li>
<li><p>其中<code>null</code>表示用于各种不能赋值的情况；</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">mysql&gt; desc person;</span><br><span class="line">+-------------+----------------------+------+-----+---------+-------+</span><br><span class="line">| Field       | Type                 | Null | Key | Default | Extra |</span><br><span class="line">+-------------+----------------------+------+-----+---------+-------+</span><br><span class="line">| person_id   | smallint(5) unsigned | NO   | PRI | NULL    |       |</span><br><span class="line">| fname       | varchar(20)          | YES  |     | NULL    |       |</span><br><span class="line">| lname       | varchar(20)          | YES  |     | NULL    |       |</span><br><span class="line">| gender      | enum(&#39;M&#39;,&#39;F&#39;)        | YES  |     | NULL    |       |</span><br><span class="line">| birth_date  | date                 | YES  |     | NULL    |       |</span><br><span class="line">| street      | varchar(20)          | YES  |     | NULL    |       |</span><br><span class="line">| ciry        | varchar(20)          | YES  |     | NULL    |       |</span><br><span class="line">| state       | varchar(20)          | YES  |     | NULL    |       |</span><br><span class="line">| country     | varchar(20)          | YES  |     | NULL    |       |</span><br><span class="line">| postal_code | varchar(20)          | YES  |     | NULL    |       |</span><br><span class="line">+-------------+----------------------+------+-----+---------+-------+</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>以下语句可以展示创建表的语句</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">mysql&gt; show create table person;</span><br><span class="line">+--------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| Table  | Create Table                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |</span><br><span class="line">+--------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| person | CREATE TABLE &#96;person&#96; (</span><br><span class="line">  &#96;person_id&#96; smallint(5) unsigned NOT NULL AUTO_INCREMENT,</span><br><span class="line">  &#96;fname&#96; varchar(20) DEFAULT NULL,</span><br><span class="line">  &#96;lname&#96; varchar(20) DEFAULT NULL,</span><br><span class="line">  &#96;gender&#96; enum(&#39;M&#39;,&#39;F&#39;) DEFAULT NULL,</span><br><span class="line">  &#96;birth_date&#96; date DEFAULT NULL,</span><br><span class="line">  &#96;street&#96; varchar(20) DEFAULT NULL,</span><br><span class="line">  &#96;ciry&#96; varchar(20) DEFAULT NULL,</span><br><span class="line">  &#96;state&#96; varchar(20) DEFAULT NULL,</span><br><span class="line">  &#96;country&#96; varchar(20) DEFAULT NULL,</span><br><span class="line">  &#96;postal_code&#96; varchar(20) DEFAULT NULL,</span><br><span class="line">  PRIMARY KEY (&#96;person_id&#96;)</span><br><span class="line">) ENGINE&#x3D;InnoDB AUTO_INCREMENT&#x3D;3 DEFAULT CHARSET&#x3D;latin1 |</span><br><span class="line">+--------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<ul>
<li>接下来创建favorite_food表</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">mysql&gt; create table favorite_food(</span><br><span class="line">    -&gt; person_id smallint unsigned,</span><br><span class="line">    -&gt; food varchar(20),</span><br><span class="line">    -&gt; constraint pk_favorite_food primary key(person_id,food),</span><br><span class="line">    -&gt; constraint pk_fav_food_person_id foreign key(person_id) references person(person_id)</span><br><span class="line">    -&gt; );</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>其中pk_fav_food_person_id为外键　references person表的person_id，pk_favorite_food为联合主键，他们都属于约束。</li>
</ul>
<h2 id="操作与修改表"><a href="#操作与修改表" class="headerlink" title="操作与修改表"></a>操作与修改表</h2><ul>
<li>修改主键为自动增长</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">mysql&gt; alter table person modify person_id smallint unsigned auto_increment;</span><br><span class="line">Query OK, 0 rows affected (0.82 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; desc person;</span><br><span class="line">+-------------+----------------------+------+-----+---------+----------------+</span><br><span class="line">| Field       | Type                 | Null | Key | Default | Extra          |</span><br><span class="line">+-------------+----------------------+------+-----+---------+----------------+</span><br><span class="line">| person_id   | smallint(5) unsigned | NO   | PRI | NULL    | auto_increment |</span><br><span class="line">| fname       | varchar(20)          | YES  |     | NULL    |                |</span><br><span class="line">| lname       | varchar(20)          | YES  |     | NULL    |                |</span><br><span class="line">| gender      | enum(&#39;M&#39;,&#39;F&#39;)        | YES  |     | NULL    |                |</span><br><span class="line">| birth_date  | date                 | YES  |     | NULL    |                |</span><br><span class="line">| street      | varchar(20)          | YES  |     | NULL    |                |</span><br><span class="line">| ciry        | varchar(20)          | YES  |     | NULL    |                |</span><br><span class="line">| state       | varchar(20)          | YES  |     | NULL    |                |</span><br><span class="line">| country     | varchar(20)          | YES  |     | NULL    |                |</span><br><span class="line">| postal_code | varchar(20)          | YES  |     | NULL    |                |</span><br><span class="line">+-------------+----------------------+------+-----+---------+----------------+</span><br><span class="line"></span><br><span class="line"> </span><br></pre></td></tr></table></figure>

<ul>
<li>插入数据操作</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">mysql&gt; insert into person(person_id,fname,lname,gender,birth_date) values(null,&#39;william&#39;,&#39;turnar&#39;,&#39;M&#39;,&#39;1972-05-27&#39;);</span><br><span class="line">Query OK, 1 row affected (0.06 sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>注意：插入的birth_date　字段的值为字符串类型，mysql数据库会将字符串自动解析为date类型。</p>
<ul>
<li>查询语句</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">mysql&gt; select * from person;</span><br><span class="line">+-----------+---------+--------+--------+------------+--------+------+-------+---------+-------------+</span><br><span class="line">| person_id | fname   | lname  | gender | birth_date | street | ciry | state | country | postal_code |</span><br><span class="line">+-----------+---------+--------+--------+------------+--------+------+-------+---------+-------------+</span><br><span class="line">|         1 | william | turnar | M      | 1972-05-27 | NULL   | NULL | NULL  | NULL    | NULL        |</span><br><span class="line">+-----------+---------+--------+--------+------------+--------+------+-------+---------+-------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>注意，生产环境中，最好不要使用 *,这样会加重解析器的负担，使得查询的效率变低。</p>
<ul>
<li>更新语句</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">mysql&gt; update person set street&#x3D;&#39;beijing&#39; where person_id&#x3D;1;</span><br><span class="line">Query OK, 1 row affected (0.04 sec)</span><br><span class="line">Rows matched: 1  Changed: 1  Warnings: 0</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>删除语句</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">mysql&gt; delete from person where person_id &#x3D;1;</span><br><span class="line">Query OK, 1 row affected (0.07 sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>注意 不要忘记where子句，否者会删除表中所有的数据。</p>
<h2 id="导致错误的语句"><a href="#导致错误的语句" class="headerlink" title="导致错误的语句"></a>导致错误的语句</h2><ul>
<li>插入的主键不唯一;</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">mysql&gt; insert into person(person_id,fname,lname,gender,birth_date) values(1,&#39;william&#39;,&#39;turnar&#39;,&#39;M&#39;,&#39;1972-05-27&#39;);</span><br><span class="line">ERROR 1062 (23000): Duplicate entry &#39;1&#39; for key &#39;PRIMARY&#39;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>插入不存在的外键;</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">mysql&gt; insert into favorite_food values(22222,&#39;noodles&#39;);</span><br><span class="line">ERROR 1452 (23000): Cannot add or update a child row: a foreign key constraint</span><br><span class="line"> fails (&#96;bank&#96;.&#96;favorite_food&#96;, CONSTRAINT &#96;favorite_food_ibfk_1&#96; FOREIGN KEY (&#96;person_id&#96;) REFERENCES &#96;person&#96; (&#96;person_id&#96;))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>由于favorite_food表中的person_id是依赖于person表的，可以将favorite_food看做是person表的子表。</p>
<ul>
<li>列值不合法</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">mysql&gt; update person set gender &#x3D;&#39;X&#39; where person_id &#x3D;1;</span><br><span class="line">ERROR 1265 (01000): Data truncated for column &#39;gender&#39; at row 1</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>gender是枚举类，只接受f 和ｍ</p>
<ul>
<li>无效的日期类型</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">mysql&gt; update person set birth_date &#x3D;&#39;DEC-21-1990&#39; where person_id &#x3D;2;</span><br><span class="line">ERROR 1292 (22007): Incorrect date value: &#39;DEC-21-1990&#39; for column &#39;birth_date&#39; at row 1</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>可以使用日期转化函数 str_to_date</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">update person set birth_date&#x3D;str_to_date(&#39;DEC-21-1990&#39;,&#39;%b-%d-%Y’) where person_id &#x3D;2;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="mysql的数据类型"><a href="#mysql的数据类型" class="headerlink" title="mysql的数据类型"></a>mysql的数据类型</h2><h3 id="字符型数据"><a href="#字符型数据" class="headerlink" title="字符型数据"></a>字符型数据</h3><p><em>字符类型数据可以分为２种：</em></p>
<ul>
<li>定长的char类型，它需要使用空格向右填充； max  255byte</li>
<li>变长的字符串 varchar类型，不需要向右填充，并且所有的字节数可变。max 65535bye　即 ６４ｋ</li>
<li>当定义一个字符列时，必须制定该列所能存放的字符串的最大长度。</li>
</ul>
<p><em>字符集：</em></p>
<ul>
<li>mysql可以使用各种字符集来存储数据，使用<code>show character set;</code> 可以查看字符集列表，默认的安装数据库时，lantin1字符集会被<br>默认的选为字符集。</li>
<li>可以使用以下语句，在创建数据库的时候制定字符集；</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">mysql&gt; create database foreign_sales character set utf8;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><em>文本数据</em></p>
<ul>
<li>当需要存储的数据大于64KB(VARCHAR的上限)　就要使用文本类型：</li>
</ul>
<ul>
<li>tinytext(255 byte) </li>
<li>text(65535 byte) </li>
<li>mediumtext(16777215 byte) </li>
<li>longtext(4294967295 byte) </li>
</ul>
<p><code>需要注意</code>：</p>
<ul>
<li>如果装载的长度超过该类型的最大长度，数据将会被阶段；</li>
<li>文本不会消除数据的尾部空格；</li>
</ul>
<h3 id="数值型数据"><a href="#数值型数据" class="headerlink" title="数值型数据"></a>数值型数据</h3><p><em>整数类型 :</em> 　</p>
<ul>
<li>tinyint : 0-255;</li>
<li>smallint : 0-65535(六万);</li>
<li>mediumint : 0-26777215 (一千六百万);</li>
<li>int : 0-42亿;</li>
<li>bigint : 0　~ ;</li>
</ul>
<p><em>浮点类型：</em></p>
<ul>
<li>float(p,s)</li>
<li>double(p,s)</li>
</ul>
<h3 id="时间数据"><a href="#时间数据" class="headerlink" title="时间数据"></a>时间数据</h3><p>时间类型分为:<br>date    year     time     datetime     timestamp<br>其中后２个是相同的格式，只不过timestamp的范围为　1970-01-01 00:00:00至2037-12-31 23:59:59 且mysql中可以生成timestamp<br>类型的时间数据。</p>
<ul>
<li><a target="_blank" rel="noopener" href="http://www.runoob.com/sql/sql-datatypes.html">具体的数据类型参考手册</a></li>
<li><a target="_blank" rel="noopener" href="http://www.cnblogs.com/jerrylz/p/5814460.html">java数据类型和mysql数据类型对应表</a>    </li>
</ul>
<h3 id="字符串相关的函数"><a href="#字符串相关的函数" class="headerlink" title="字符串相关的函数"></a>字符串相关的函数</h3><ul>
<li><p>当插入的字符串的长度超过指定的字段的长度时，服务器会抛出异常。这是mysql服务器的默认操作，可以修改其配置，改成截取字符串后插入，不抛出任何异常。</p>
</li>
<li><p>由于mysql中的字符串使用单引号分割，所以字符串中包含单引号时可以使用 ‘\’或者单引号作为转义，即两个单引号。</p>
</li>
<li><p>length()函数返回字符串的个数,这个获取长度时会删除char类型的尾端的空格。</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">+---------+--------------+------------+-------------+</span><br><span class="line">| cust_id | name         | state_id   | incorp_date |</span><br><span class="line">+---------+--------------+------------+-------------+</span><br><span class="line">|      10 | jamesd &#39;hand | 12-345-678 | 1995-05-01  |</span><br><span class="line">+---------+--------------+------------+-------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select length(name) from business where cust_id&#x3D;10;</span><br><span class="line">+--------------+</span><br><span class="line">| length(name) |</span><br><span class="line">+--------------+</span><br><span class="line">|           12 |</span><br><span class="line">+--------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>REGEXP操作符（模式匹配）</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">mysql&gt; select cust_id,fed_id,fed_id REGEXP &#39;.&#123;3&#125;-.&#123;2&#125;-.&#123;4&#125;&#39; isFomart from customer;</span><br><span class="line">+---------+-------------+----------+</span><br><span class="line">| cust_id | fed_id      | isFomart |</span><br><span class="line">+---------+-------------+----------+</span><br><span class="line">|       1 | 111-11-1111 |        1 |</span><br><span class="line">|       2 | 222-22-2222 |        1 |</span><br><span class="line">|       3 | 333-33-3333 |        1 |</span><br><span class="line">|       4 | 444-44-4444 |        1 |</span><br><span class="line">|       5 | 555-55-5555 |        1 |</span><br><span class="line">|       6 | 666-66-6666 |        1 |</span><br><span class="line">|       7 | 777-77-7777 |        1 |</span><br><span class="line">|       8 | 888-88-8888 |        1 |</span><br><span class="line">|       9 | 999-99-9999 |        1 |</span><br><span class="line">|      10 | 04-1111111  |        0 |</span><br><span class="line">|      11 | 04-2222222  |        0 |</span><br><span class="line">|      12 | 04-3333333  |        0 |</span><br><span class="line">|      13 | 04-4444444  |        0 |</span><br><span class="line">+---------+-------------+----------+</span><br><span class="line">13 rows in set (0.00 sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>concat() 返回字符串的字符串函数</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">mysql&gt; select concat(fname,&#39; &#39;,lname,&#39; has been a title  &#39;,&#39;since &#39;,start_date) emp_narrative from employee where title &#x3D;&#39;Teller&#39;;</span><br><span class="line">+-----------------------------------------------------+</span><br><span class="line">| emp_narrative                                       |</span><br><span class="line">+-----------------------------------------------------+</span><br><span class="line">| Chris Tucker has been a title  since 2004-09-15     |</span><br><span class="line">| Sarah Parker has been a title  since 2002-12-02     |</span><br><span class="line">| Jane Grossman has been a title  since 2002-05-03    |</span><br><span class="line">| Thomas Ziegler has been a title  since 2000-10-23   |</span><br><span class="line">| Samantha Jameson has been a title  since 2003-01-08 |</span><br><span class="line">| Cindy Mason has been a title  since 2002-08-09      |</span><br><span class="line">| Frank Portman has been a title  since 2003-04-01    |</span><br><span class="line">| Beth Fowler has been a title  since 2002-06-29      |</span><br><span class="line">| Rick Tulman has been a title  since 2002-12-12      |</span><br><span class="line">+-----------------------------------------------------+</span><br><span class="line">9 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>SubString(字段，1，end) - 从某个文本字段提取字符</li>
</ul>
<h3 id="数字相关的函数"><a href="#数字相关的函数" class="headerlink" title="数字相关的函数"></a>数字相关的函数</h3><ul>
<li>mod() 求余操作</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">mysql&gt; select mod(22.75,5);</span><br><span class="line">+--------------+</span><br><span class="line">| mod(22.75,5) |</span><br><span class="line">+--------------+</span><br><span class="line">|         2.75 |</span><br><span class="line">+--------------+</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li><p>ceil()和floor()向上和向下取整操作</p>
</li>
<li><p>round()四舍五入操作</p>
</li>
<li><p>ROUND(X,D)： 返回参数X的四舍五入的有 D 位小数的一个数字。如果D为0，结果将没有小数点或小数部分。</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">mysql&gt; select round(1.287,1) as result;</span><br><span class="line">+--------+</span><br><span class="line">| result |</span><br><span class="line">+--------+</span><br><span class="line">|    1.3 |</span><br><span class="line">+--------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>处理有符号数</li>
</ul>
<p>sign()函数余额为负数时返回-1，为0时返回0，为正数时返回1。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">mysql&gt; select account_id,sign(avail_balance),abs(avail_balance) from account;</span><br><span class="line">+------------+---------------------+--------------------+</span><br><span class="line">| account_id | sign(avail_balance) | abs(avail_balance) |</span><br><span class="line">+------------+---------------------+--------------------+</span><br><span class="line">|          1 |                   1 |            1057.75 |</span><br><span class="line">|          2 |                   1 |             500.00 |</span><br><span class="line">|          3 |                   1 |            3000.00 |</span><br><span class="line">|          4 |                   1 |            2258.02 |</span><br><span class="line">|          5 |                   1 |             200.00 |</span><br><span class="line">|          7 |                   1 |            1057.75 |</span><br><span class="line">|          8 |                   1 |            2212.50 |</span><br><span class="line">|         10 |                   1 |             534.12 |</span><br><span class="line">|         11 |                   1 |             767.77 |</span><br><span class="line">|         12 |                   1 |            5487.09 |</span><br><span class="line">|         13 |                   1 |            2237.97 |</span><br><span class="line">|         14 |                   1 |             122.37 |</span><br><span class="line">|         15 |                   1 |           10000.00 |</span><br><span class="line">|         17 |                   1 |            5000.00 |</span><br><span class="line">|         18 |                   1 |            3487.19 |</span><br><span class="line">|         19 |                   1 |             387.99 |</span><br><span class="line">|         21 |                   1 |             125.67 |</span><br><span class="line">|         22 |                   1 |            9345.55 |</span><br><span class="line">|         23 |                   1 |            1500.00 |</span><br><span class="line">|         24 |                   1 |           23575.12 |</span><br><span class="line">|         25 |                   0 |               0.00 |</span><br><span class="line">|         27 |                   1 |            9345.55 |</span><br><span class="line">|         28 |                   1 |           38552.05 |</span><br><span class="line">|         29 |                   1 |           50000.00 |</span><br><span class="line">+------------+---------------------+--------------------+</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>AVG() - 返回平均值</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">语法：</span><br><span class="line">SELECT AVG(column_name) FROM table_name</span><br><span class="line"></span><br><span class="line">例子：</span><br><span class="line">从 &quot;access_log&quot; 表的 &quot;count&quot; 列获取平均值：</span><br><span class="line"></span><br><span class="line">mysql&gt; select AVG(count) as countASAverage from access_log;</span><br><span class="line">+----------------+</span><br><span class="line">| countASAverage |</span><br><span class="line">+----------------+</span><br><span class="line">|       174.3333 |</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">选择访问量高于平均访问量的 &quot;site_id&quot; 和 &quot;count&quot;：</span><br><span class="line">mysql&gt; select site_id,count from access_log where count&gt;(select AVG(count) from access_log);</span><br><span class="line">+---------+-------+</span><br><span class="line">| site_id | count |</span><br><span class="line">+---------+-------+</span><br><span class="line">|       1 |   230 |</span><br><span class="line">|       5 |   205 |</span><br><span class="line">|       3 |   220 |</span><br><span class="line">|       5 |   545 |</span><br><span class="line">|       3 |   201 |</span><br><span class="line">+---------+-------+</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h3 id="日期相关的函数"><a href="#日期相关的函数" class="headerlink" title="日期相关的函数"></a>日期相关的函数</h3><ul>
<li><p>当一个字段为date   dateTime  time timestamp类型的时候，插入一个数据为字符串类型时，则服务器会将字符串转变为该类型。</p>
</li>
<li><p>str_to_date()格式化函数</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; update individual set birth_date &#x3D;STR_TO_DATE(&#39;September 17,2008&#39;,&#39;%M %d, %Y&#39;) where cust_id &#x3D;1;</span><br><span class="line">Query OK, 1 row affected (0.04 sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<ul>
<li>current_date(),current_time(),current_timestamp() 时间函数</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">mysql&gt; select current_date(),current_time(),current_timestamp();</span><br><span class="line">+----------------+----------------+---------------------+</span><br><span class="line">| current_date() | current_time() | current_timestamp() |</span><br><span class="line">+----------------+----------------+---------------------+</span><br><span class="line">| 2017-11-29     | 00:26:22       | 2017-11-29 00:26:22 |</span><br><span class="line">+----------------+----------------+---------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<ul>
<li>date_add()函数</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&#x2F;&#x2F;第二个参数包含了3个参数，分别是interval关键字，数量，和时间间隔类型</span><br><span class="line"></span><br><span class="line">mysql&gt; select date_add(current_date(),interval 5 day);</span><br><span class="line">+-----------------------------------------+</span><br><span class="line">| date_add(current_date(),interval 5 day) |</span><br><span class="line">+-----------------------------------------+</span><br><span class="line">| 2017-12-04                              |</span><br><span class="line">+-----------------------------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">type 参数可以是下列值：</span><br><span class="line">Type 值</span><br><span class="line">MICROSECOND</span><br><span class="line">SECOND</span><br><span class="line">MINUTE</span><br><span class="line">HOUR</span><br><span class="line">DAY</span><br><span class="line">WEEK</span><br><span class="line">MONTH</span><br><span class="line">QUARTER</span><br><span class="line">YEAR</span><br><span class="line">SECOND_MICROSECOND</span><br><span class="line">MINUTE_MICROSECOND</span><br><span class="line">MINUTE_SECOND</span><br><span class="line">HOUR_MICROSECOND</span><br><span class="line">HOUR_SECOND</span><br><span class="line">HOUR_MINUTE</span><br><span class="line">DAY_MICROSECOND</span><br><span class="line">DAY_SECOND</span><br><span class="line">DAY_MINUTE</span><br><span class="line">DAY_HOUR</span><br><span class="line">YEAR_MONTH</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>last_day()函数</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">mysql&gt; select last_day(&#39;2008-09-17&#39;);</span><br><span class="line">+------------------------+</span><br><span class="line">| last_day(&#39;2008-09-17&#39;) |</span><br><span class="line">+------------------------+</span><br><span class="line">| 2008-09-30             |</span><br><span class="line">+------------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select last_day(now());</span><br><span class="line">+-----------------+</span><br><span class="line">| last_day(now()) |</span><br><span class="line">+-----------------+</span><br><span class="line">| 2017-11-30      |</span><br><span class="line">+-----------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<ul>
<li>dayname() 返回某一天时星期几</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">mysql&gt; select dayname(&#39;2008-03-27&#39;);</span><br><span class="line">+-----------------------+</span><br><span class="line">| dayname(&#39;2008-03-27&#39;) |</span><br><span class="line">+-----------------------+</span><br><span class="line">| Thursday              |</span><br><span class="line">+-----------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>extract()截取日期的函数</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">mysql&gt; select extract(year from now());</span><br><span class="line">+--------------------------+</span><br><span class="line">| extract(year from now()) |</span><br><span class="line">+--------------------------+</span><br><span class="line">|                     2017 |</span><br><span class="line">+--------------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<ul>
<li>datediff() 返回两个时间的像个的天数 （距今比较远的为第一个参数，则返回整数）</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">mysql&gt; select datediff(&#39;2011-05-03&#39;,&#39;2010-08-03&#39;);</span><br><span class="line">+-------------------------------------+</span><br><span class="line">| datediff(&#39;2011-05-03&#39;,&#39;2010-08-03&#39;) |</span><br><span class="line">+-------------------------------------+</span><br><span class="line">|                                 273 |</span><br><span class="line">+-------------------------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>date常用函数</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">函数            描述</span><br><span class="line">NOW()        返回当前的日期和时间</span><br><span class="line">CURDATE()    返回当前的日期</span><br><span class="line">CURTIME()    返回当前的时间</span><br><span class="line">DATE()        提取日期或日期&#x2F;时间表达式的日期部分</span><br><span class="line">EXTRACT()    返回日期&#x2F;时间的单独部分</span><br><span class="line">DATE_ADD()    向日期添加指定的时间间隔</span><br><span class="line">DATE_SUB()    从日期减去指定的时间间隔</span><br><span class="line">DATEDIFF()    返回两个日期之间的天数</span><br><span class="line">DATE_FORMAT()    用不同的格式显示日期&#x2F;时间</span><br><span class="line"></span><br><span class="line">mysql&gt; select </span><br><span class="line">    -&gt; DATE_FORMAT(NOW(),&#39;%b %d %Y %h:%i %p&#39;) as date1 ,</span><br><span class="line">    -&gt; DATE_FORMAT(NOW(),&#39;%m-%d-%Y&#39;) as date2,</span><br><span class="line">    -&gt; DATE_FORMAT(NOW(),&#39;%d %b %y&#39;) as date3,</span><br><span class="line">    -&gt; DATE_FORMAT(NOW(),&#39;%d %b %y&#39;) as date4;</span><br><span class="line"></span><br><span class="line">+----------------------+------------+-----------+-----------+</span><br><span class="line">| date1                | date2      | date3     | date4     |</span><br><span class="line">+----------------------+------------+-----------+-----------+</span><br><span class="line">| Nov 05 2017 11:05 PM | 11-05-2017 | 05 Nov 17 | 05 Nov 17 |</span><br><span class="line">+----------------------+------------+-----------+-----------+</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>









      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://chenwj1103.github.io/2017-10-14/web-session%E5%92%8Ccookie%E7%9A%84%E5%8C%BA%E5%88%AB/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/favicon.ico">
      <meta itemprop="name" content="陈伟杰">
      <meta itemprop="description" content="学习，坚持。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="茄子的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017-10-14/web-session%E5%92%8Ccookie%E7%9A%84%E5%8C%BA%E5%88%AB/" class="post-title-link" itemprop="url">web-session和cookie的区别</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-10-14 00:02:19" itemprop="dateCreated datePublished" datetime="2017-10-14T00:02:19+08:00">2017-10-14</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-08-21 01:03:09" itemprop="dateModified" datetime="2020-08-21T01:03:09+08:00">2020-08-21</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/web/" itemprop="url" rel="index"><span itemprop="name">web</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>1.7k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>2 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="session和cookie时开发中常用到的两个对象。"><a href="#session和cookie时开发中常用到的两个对象。" class="headerlink" title="session和cookie时开发中常用到的两个对象。"></a>session和cookie时开发中常用到的两个对象。</h2><h4 id="cookie"><a href="#cookie" class="headerlink" title="cookie"></a>cookie</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">    cookie是一小段文本信息，伴随着用户请求和页面在web服务器和浏览器之间传递。cookie包含每次用户访问站点用户都可以读取的</span><br><span class="line">信息。(cookie会随着每次http请求一起被传到服务端）</span><br><span class="line">    当你在浏览网站的时候，WEB 服务器会先送一小小资料放在你的计算机上，Cookie 会帮你在网站上所打的文字或是一些选择，都纪</span><br><span class="line">录下来。当下次你再光临同一个网站，WEB 服务器会先看看有没有它上次留下的 Cookie 资料，有的话，就会依据 Cookie里的内容来判</span><br><span class="line">断使用者，送出特定的网页内容给你。 Cookie 的使用很普遍，许多有提供个人化服务的网站，都是利用 Cookie来辨认使用者，以方便</span><br><span class="line">送出使用者量身定做的内容，像是 Web 接口的免费 email 网站，都要用到 Cookie。 </span><br><span class="line">    具体来说cookie机制采用的是在客户端保持状态的方案，而session机制采用的是在服务器端保持状态的方案。</span><br><span class="line">    cookie的内容主要包括：名字，值，过期时间，路径和域。路径与域一起构成cookie的作用范围。若不设置过期时间，则表示这个</span><br><span class="line">cookie的生命期为浏览器会话期间，关闭浏览器窗口，cookie就消失。这种生命期为浏览器会话期的cookie被称为会话cookie。会话</span><br><span class="line">cookie一般不存储在硬盘上而是保存在内存里，当然这种行为并不是规范规定的。若设置了过期时间，浏览器就会把cookie保存到硬</span><br><span class="line">盘上，关闭后再次打开浏览器，这些cookie仍然有效直到超过设定的过期时间。存储在硬盘上的cookie可以在不同的浏览器进程间共</span><br><span class="line">享，比如两个IE窗口。而对于保存在内存里的cookie，不同的浏览器有不同的处理方式。</span><br></pre></td></tr></table></figure>
<h4 id="session"><a href="#session" class="headerlink" title="session"></a>session</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">    session我们可以使用它来方便地在服务端保存一些与会话相关的信息。比如常见的登录信息。</span><br><span class="line">    session实现原理：http协议是无状态的，对于一个浏览器发出的多次请求，web服务无法区分是不是来自同一个浏览器。所以会</span><br><span class="line">通过一个sessionid来区分。</span><br><span class="line">    当程序需要为某个客户端的请求创建一个session时，服务器首先检查这个客户端的请求里是否已包含了一个session标识(称为</span><br><span class="line">session id），如果已包含则说明以前已经为此客户端创建过session，服务器就按照session id把这个session检索出来使用（检索</span><br><span class="line">不到，会新建一个），如果客户端请求不包含session id，则为此客户端创建一个session并且生成一个与此session相关联的session</span><br><span class="line"> id，session id的值应该是一个既不会重复，又不容易被找到规律以仿造的字符串，这个session id将被在本次响应中返回给客户端保</span><br><span class="line">存。保存这个session id的方式可以采用cookie，这样在交互过程中浏览器可以自动的按照规则把这个标识发送给服务器。一般这个</span><br><span class="line">cookie的名字都是类似于SEEESIONID。但cookie可以被人为的禁止，则必须有其他机制以便在cookie被禁止时仍然能够把session id</span><br><span class="line">传递回服务器。</span><br><span class="line">    经常被使用的一种技术叫做URL重写，就是把session id直接附加在URL路径的后面。还有一种技术叫做表单隐藏字段。就是服务器</span><br><span class="line">会自动修改表单，添加一个隐藏字段，以便在表单提交时能够把session id传递回服务器。</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="cookie-和session-的区别："><a href="#cookie-和session-的区别：" class="headerlink" title="cookie 和session 的区别："></a>cookie 和session 的区别：</h4><ol>
<li>cookie数据存放在客户的浏览器上，session数据放在服务器上。</li>
<li>cookie不是很安全，别人可以分析存放在本地的COOKIE并进行COOKIE欺骗<br>考虑到安全应当使用session。</li>
<li>session会在一定时间内保存在服务器上。当访问增多，会比较占用你服务器的性能<br>考虑到减轻服务器性能方面，应当使用COOKIE。</li>
<li>单个cookie保存的数据不能超过4K，很多浏览器都限制一个站点最多保存20个cookie。</li>
<li>所以个人建议：<br> 将登陆信息等重要信息存放为SESSION；其他信息如果需要保留，可以放在COOKIE中</li>
</ol>
<p><a target="_blank" rel="noopener" href="https://maimai.cn/article/detail?fid=971952342&efid=LLj6y1u5UJki64UG-HamIA">session深入探讨</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://chenwj1103.github.io/2017-10-10/hexo%E7%BB%9F%E8%AE%A1%E9%85%8D%E7%BD%AE/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/favicon.ico">
      <meta itemprop="name" content="陈伟杰">
      <meta itemprop="description" content="学习，坚持。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="茄子的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017-10-10/hexo%E7%BB%9F%E8%AE%A1%E9%85%8D%E7%BD%AE/" class="post-title-link" itemprop="url">hexo统计配置</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-10-10 00:50:14" itemprop="dateCreated datePublished" datetime="2017-10-10T00:50:14+08:00">2017-10-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-08-21 01:03:09" itemprop="dateModified" datetime="2020-08-21T01:03:09+08:00">2020-08-21</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%8D%9A%E5%AE%A2/" itemprop="url" rel="index"><span itemprop="name">博客</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>780</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>后续会整理hexo搭建博客的完整流程，包括过程中踩过的坑。</p>
<h1 id="统计"><a href="#统计" class="headerlink" title="统计"></a>统计</h1><ol>
<li><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/702a7aec4d00">leancloud统计</a></li>
<li>卜算子统计 (/themes/next/_config.yml) 路径的themes的next的_config.xml文件中 enable改为true即可.</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"># Show PV&#x2F;UV of the website&#x2F;page with busuanzi.</span><br><span class="line"># Get more information on http:&#x2F;&#x2F;ibruce.info&#x2F;2015&#x2F;04&#x2F;04&#x2F;busuanzi&#x2F;</span><br><span class="line">busuanzi_count:</span><br><span class="line">  # count values only if the other configs are false</span><br><span class="line">  enable: true</span><br><span class="line">  # custom uv span for the whole site</span><br><span class="line">  site_uv: true</span><br><span class="line">  site_uv_header: &lt;i class&#x3D;&quot;fa fa-user&quot;&gt;&lt;&#x2F;i&gt;</span><br><span class="line">  site_uv_footer:</span><br><span class="line">  # custom pv span for the whole site</span><br><span class="line">  site_pv: true</span><br><span class="line">  site_pv_header: &lt;i class&#x3D;&quot;fa fa-eye&quot;&gt;&lt;&#x2F;i&gt;</span><br><span class="line">  site_pv_footer:</span><br><span class="line">  # custom pv span for one page only</span><br><span class="line">  page_pv: true</span><br><span class="line">  page_pv_header: &lt;i class&#x3D;&quot;fa fa-file-o&quot;&gt;&lt;&#x2F;i&gt;</span><br><span class="line">  page_pv_footer:</span><br></pre></td></tr></table></figure>
<h1 id="其它"><a href="#其它" class="headerlink" title="其它"></a>其它</h1><ol>
<li><a target="_blank" rel="noopener" href="http://shenzekun.cn/hexo%E7%9A%84next%E4%B8%BB%E9%A2%98%E4%B8%AA%E6%80%A7%E5%8C%96%E9%85%8D%E7%BD%AE%E6%95%99%E7%A8%8B.html">next主题秘籍</a></li>
<li><a target="_blank" rel="noopener" href="http://www.yuan-ji.me/Hexo-%E4%BC%98%E5%8C%96%EF%BC%9A%E6%8F%90%E4%BA%A4sitemap%E5%8F%8A%E8%A7%A3%E5%86%B3%E7%99%BE%E5%BA%A6%E7%88%AC%E8%99%AB%E6%8A%93%E5%8F%96-GitHub-Pages-%E9%97%AE%E9%A2%98/">优化百度收录博客文章</a></li>
<li><a target="_blank" rel="noopener" href="https://tongji.baidu.com/web/24767668/homepage/index">百度统计</a></li>
<li><a target="_blank" rel="noopener" href="http://dashboard.daovoice.io/app/7e36aff1/users?segment=all-users">daoVoice</a></li>
<li><a target="_blank" rel="noopener" href="https://livere.com/insight">来必力</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/the0demiurge/CharlesScripts/blob/master/charles/bin/ssr">SSR客户端</a></li>
<li><a target="_blank" rel="noopener" href="https://www.djangoz.com/2017/08/16/linux_setup_ssr/">SSR客户端2</a></li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/7/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><span class="page-number current">8</span>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="陈伟杰"
      src="/images/favicon.ico">
  <p class="site-author-name" itemprop="name">陈伟杰</p>
  <div class="site-description" itemprop="description">学习，坚持。</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">74</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">26</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">68</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/chenwj1103" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;chenwj1103" rel="noopener" target="_blank"><i class="github fa-fw"></i>GitHub</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">陈伟杰</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
      <span class="post-meta-item-text">站点总字数：</span>
    <span title="站点总字数">638k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span class="post-meta-item-text">站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">9:40</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

</body>
</html>
